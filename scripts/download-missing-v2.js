/**
 * SCRIPT PARA BAIXAR IMAGENS FALTANDO
 * 
 * INSTRUÃ‡Ã•ES:
 * 1. Abra https://ragnatales.com.br/db/items no navegador
 * 2. Abra o DevTools (F12) â†’ Console
 * 3. Cole este script e pressione Enter
 * 4. As imagens serÃ£o baixadas em um ZIP
 */

(async function() {
  const MISSING_IDS = [
    "24940","510032","24954","700032","18152","18149","1865","24951","630012","550026",
    "24946","28762","24944","540021","32301","640019","24952","640033","610022","580017",
    "540042","24941","640028","640024","520024","580011","24955","24945","620029","28740",
    "590045","510023","520044","640012","24949","610017","610018","680006","640034","620026",
    "630014","610019","28759","28760","510024","24948","550012","570019","580016","24953",
    "530012","18147","630013","28763","620018","24947","610020","520041","600024","530020",
    "700030","540047","520025","640023","24943","28761","610021","540020","580015","18148",
    "520021","1866","610024","640030","520030","590014","32257","530016","24942","530019",
    "620017","640018","560011","510021","620022","520040","570014","570013","620021","560019",
    "540024","610023","28764","520037","580010","530014","520029","560015","550023","560014",
    "580019","640021","620025","540046","630008","700031","560018","630010","630011","580020",
    "640017","600020","610016","550022","580018","540023","560017","520022","600019","520020",
    "510022","590013","700033","530017","530013","600018","620019","560016","550021","640022",
    "530018","640020","590044","700029","620020","540022","600021","640029","520039","18150",
    "520023","550020","620023","640031","570017","600022","640015","590043","570016","18151",
    "570018","640032","550024","600023","580013","580014","520036","520038","640016","590042",
    "640027","28766","510030","540043","700034","520043","550013","560013","620024","640026",
    "580012","520026","510025","640025","570015","520042","550025","24950","540044","610025",
    "520031","530021","510027","540045","510028","540041","530015","510029","560012","510026",
    "5794","460005","31312","24975","400054","31385","420029","31617","19373","21056",
    "31502","5873","460009","400049","28802","31493","470023","21071","31323","31598",
    "18769","5964","21061","20915","31506","400060","31531","19440","420025","400057",
    "31616","31382","480036","19355","19356","400062","480030","19387","460007","21104",
    "28841","5972","21097","20980","21085","400061","28800","480029","31590","31504",
    "31501","31415","21073","490041","31877","480038","21094","28860","19378","21089",
    "21091","28839","21060","490044","31329","400063","31877","460006","420008","400055",
    "19400","420030","21105","31380","28803","18798","19345","5883","410017","28869",
    "460008","31587","400053","470024","31505","21086","21069","28919","470022","31561",
    "21100","400050","420024","5968","28801","28837","19332","31562","28856","21102",
    "21062","400052","31381","31589","31600","410018","470021","19359","21088","28844",
    "19393","21109","32259","31601","21055","28921","21075","28855","400051","31421",
    "28847","19336","21087","420027","21098","31321","31563","5965","18761","19375",
    "31325","28848","21059","19358","21096","28838","21053","31584","18765","21083",
    "21082","28866","480027","28804","32261","490043","31583","19350","21070","28920",
    "21101","21063","31560","19360","31324","18756","31507","31610","420028","28862",
    "32260","31503","28854","28858","21068","31594","21095","31585","18763","31327",
    "31599","18768","31328","31326","28853","28918","19346","5971","460010","5869",
    "31420","28917","28867","490042","28842","21107","28840","28859","31318","21092",
    "31602","21106","21090","21093","18759","21081","31591","21074","21108","28863",
    "400059","31386","28852","21057","5967","28846","19341","28868","5880","480035",
    "19392","19367","470020","18760","5881","480037","31597","21099","19389","21067",
    "18767","31595","19348","31592","5882","5970","21076","490040","31611","5879",
    "5963","19344","21054","21103","19347","19368","21058","21066","28861","31419",
    "28857","28864","400056","21064","28851","18764","28845","31320","28850","31322",
    "18766","21084","5966","21080","18762","31319","5969","28849","28865","21065",
    "410016","420026","400058","28843","21072","5974","480031"
  ];

  console.log('ðŸ–¼ï¸ Baixando', MISSING_IDS.length, 'imagens faltando...');

  // Criar um ZIP usando JSZip
  const script = document.createElement('script');
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
  document.head.appendChild(script);
  
  await new Promise(r => setTimeout(r, 2000)); // Esperar JSZip carregar
  
  const zip = new JSZip();
  let success = 0;
  let failed = 0;
  
  for (let i = 0; i < MISSING_IDS.length; i++) {
    const id = MISSING_IDS[i];
    try {
      const url = `https://api.ragnatales.com.br/database/item/icon?nameid=${id}`;
      const response = await fetch(url);
      
      if (response.ok) {
        const blob = await response.blob();
        zip.file(`${id}.png`, blob);
        success++;
      } else {
        failed++;
      }
      
      if ((i + 1) % 50 === 0) {
        console.log(`Progresso: ${i + 1}/${MISSING_IDS.length} (${success} ok, ${failed} falhas)`);
      }
      
      await new Promise(r => setTimeout(r, 100)); // Rate limit
    } catch (e) {
      failed++;
    }
  }
  
  console.log(`\nâœ… ConcluÃ­do! ${success} imagens baixadas, ${failed} falhas`);
  console.log('ðŸ“¦ Gerando ZIP...');
  
  const content = await zip.generateAsync({ type: 'blob' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(content);
  a.download = 'missing-images.zip';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  
  console.log('âœ… Download do ZIP iniciado!');
  console.log('Extraia o conteÃºdo para: public/images/ragnatales/');
})();

